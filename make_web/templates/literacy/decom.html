<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Highlight Text</title>
    <style>
        .highlight-yellow { background-color: yellow; }
        .highlight-green { background-color: lightgreen; }
        
        input[type='checkbox'] { position: absolute; left: -3000% }
        input[type='checkbox'] + label { display : inline-block; background: #CCCCCC; border-radius: 30px;}
        input[type='checkbox']:before + label {content: ''; }
        input[type='checkbox']:checked + label {content: ''; background: #FFEB9B;}
        
    </style>
</head>
<body>
    <div>
        <button type="submit" name="to_home" onclick="window.location.href='/decom'">Go to Main Page</button>
        <button type="submit" name="to_db_test" onclick="window.location.href='/db_test'">Go to DB Test</button>
    </div>

    <h3>지문을 입력해주세요.</h3>
    <form action="/decom" method="post">
        <p><textarea type="text", name="decomp", id="input", cols="50" rows="10"></textarea></p>
        <p><input type="submit" value="분해"></p>
    </form>

    <p>
        <dev style="width:800px;">
            {% for i in sent_list %}
                 {{i}}
                <br>
                <button onclick="setHighlight('highlight-yellow')">Key</button>
                <button onclick="setHighlight('highlight-green')">Point</button>
                <button onclick="removeHighlight()">모두 제거</button>
                <button onclick="showHighlighted()">저장</button>
                <br>
                <div id="result-container"></div>
                <div id="result"></div>
            {% endfor %} 
        </dev>
    </p>

    <script>

        function setHighlight(className) {
            var selection = window.getSelection().getRangeAt(0);
            var selectedText = selection.extractContents();
            var span = document.createElement('span');
            span.className = className;
            span.appendChild(selectedText);
            selection.insertNode(span);

            var highlightedWords = document.querySelectorAll("." + className);
            var words = "";
            for (var i = 0; i < highlightedWords.length; i++) {
                words += highlightedWords[i].innerText + ", ";
            }

            if (className == "highlight-yellow") {
                document.getElementById("yellow-words").innerText += words;
            } else if (className == "highlight-green") {
                document.getElementById("green-words").innerText += words;
            }
        }

        function removeHighlight() {
            var highlighted = document.querySelectorAll('.highlight-yellow, .highlight-green');
            for (var i = 0; i < highlighted.length; i++) {
                var parent = highlighted[i].parentNode;
                while (highlighted[i].firstChild) {
                    parent.insertBefore(highlighted[i].firstChild, highlighted[i]);
                }
                parent.removeChild(highlighted[i]);
            }

            document.getElementById("yellow-words").innerText = "";
            document.getElementById("green-words").innerText = "";
        }

        function showHighlighted() {
            var yellowWords = document.querySelectorAll('.highlight-yellow');
            var greenWords = document.querySelectorAll('.highlight-green');
            
            var yellowContainer = document.createElement('div');
            var greenContainer = document.createElement('div');
            
            yellowContainer.innerHTML = '<h3>KeyWord</h3>';
            greenContainer.innerHTML = '<h3>PointWord</h3>';
            
            for (var i = 0; i < yellowWords.length; i++) {
              yellowContainer.appendChild(yellowWords[i].cloneNode(true));
            }
            
            for (var i = 0; i < greenWords.length; i++) {
              greenContainer.appendChild(greenWords[i].cloneNode(true));
            }
            
            var resultContainer = document.getElementById('result-container');
            resultContainer.innerHTML = '선택한 단어 확인';
            resultContainer.appendChild(yellowContainer);
            resultContainer.appendChild(greenContainer);
          }
    </script>

</body>
</html>